!function(e,t){"use strict";function n(e){var t=e.getWrapperElement();t.className+=" CodeMirror-has-preview",i(t,e)}function i(e,t){var n,i=e.getElementsByClassName("CodeMirror-preview");if(0==i.length){var n=document.createElement("div");n.className="CodeMirror-preview",e.appendChild(n)}else n=i[0];n.innerHTML=r.makeHtml(t.getValue())}function o(e){var t=e.getWrapperElement();t.className=t.className.replace(/\s*CodeMirror-has-preview\b/,""),e.refresh()}var r=new t.Converter;t.Extra.init(r),e.defineOption("preview",!1,function(t,i,r){r==e.Init&&(r=!1),!r!=!i&&(i?n(t):o(t))})}(CodeMirror,Markdown),function(e){"use strict";function t(e,n){if(Array.isArray(n))for(var i=sources.length-1;i>=0;i--)t(e,n[i]);else for(var o in n)e[o]=n[o];return e}function n(e,n){var o={mode:"gfm",theme:"default mirrormark",tabSize:"2",indentWithTabs:!0,lineWrapping:!0,autoCloseBrackets:!0,autoCloseTags:!0,addModeClass:!0,showToolbar:!0,extraKeys:{Enter:"newlineAndIndentContinueMarkdownList"}};return t(o,n),t(Object.create(i),{element:e,options:o})}!function(e){if("object"==typeof exports&&"object"==typeof module)module.exports=e;else if("function"==typeof define&&define.amd)return define([],e);window&&(window.mirrorMark=e)}(n);var i={render:function(){this.registerKeyMaps(this.keyMaps),this.cm=e.fromTextArea(this.element,this.options),this.options.showToolbar&&this.setToolbar(this.tools)},setToolbar:function(e){var t=document.createElement("ul");t.className=this.options.theme+"-toolbar";var e=this.generateToolList(e);e.forEach(function(e){t.appendChild(e)});var n=this.cm.getWrapperElement();n.insertBefore(t,n.firstChild)},registerKeyMaps:function(t){for(var n in t){if("function"!=typeof this.actions[t[n]])throw"MirrorMark - '"+t[n]+"' is not a registered action";var i=n.replace("Cmd-",e.keyMap["default"]==e.keyMap.macDefault?"Cmd-":"Ctrl-");this.options.extraKeys[i]=this.actions[t[n]].bind(this)}},registerActions:function(e){return t(this.actions,e)},registerTools:function(e,t){for(var n in e)if(this.actions[e[n].action]&&"function"!=typeof this.actions[e[n].action])throw"MirrorMark - '"+e[n].action+"' is not a registered action";return t?void(this.tools=e):void(this.tools=this.tools.concat(e))},generateToolList:function o(e){return e.map(function(e){var t=document.createElement("li"),n=document.createElement("a");if(t.className=e.name,e.className&&(n.className=e.className),e.showName){var i=document.createTextNode(e.name);n.appendChild(i)}if(e.action&&(n.onclick=function(t){this.cm.focus(),this.actions[e.action].call(this)}.bind(this)),t.appendChild(n),e.nested){t.className+=" has-nested";var r=document.createElement("ul");r.className=this.options.theme+"-toolbar-list";var s=o.call(this,e.nested);s.forEach(function(e){r.appendChild(e)}),t.appendChild(r)}return t}.bind(this))},tools:[{name:"bold",action:"bold"},{name:"italicize",action:"italicize"},{name:"blockquote",action:"blockquote"},{name:"strikethrough",action:"strikethrough"},{name:"link",action:"link"},{name:"image",action:"image"},{name:"unorderedList",action:"unorderedList"},{name:"orderedList",action:"orderedList"},{name:"fullScreen",action:"fullScreen"},{name:"preview",action:"preview"}],keyMaps:{"Cmd-B":"bold","Cmd-I":"italicize","Cmd-'":"blockquote","Cmd-Alt-L":"orderedList","Cmd-L":"unorderedList","Cmd-Alt-I":"image","Cmd-H":"hr","Cmd-K":"link",F11:"fullScreen",Esc:"exitFullScreen"},actions:{bold:function(){this.toggleAround("**","**")},italicize:function(){this.toggleAround("*","*")},strikethrough:function(){this.toggleAround("~~","~~")},code:function(){this.toggleAround("```\r\n","\r\n```")},blockquote:function(){this.toggleBefore("> ")},orderedList:function(){this.toggleBefore("1. ")},unorderedList:function(){this.toggleBefore("* ")},image:function(){this.toggleAround("![","](http://)")},link:function(){this.toggleAround("[","](http://)")},hr:function(){this.insert("---")},fullScreen:function(){var e=!this.cm.getOption("fullScreen");e||this.cm.setOption("scrollPastEnd",e),this.cm.setOption("fullScreen",e),e&&this.cm.setOption("scrollPastEnd",e)},exitFullScreen:function(){this.cm.getOption("fullScreen")&&(this.cm.setOption("scrollPastEnd",fullScreen),this.cm.setOption("fullScreen",!1))},preview:function(){this.cm.setOption("preview",!this.cm.getOption("preview"))}},insert:function(e){var t=this.cm.getDoc(),n=t.getCursor();t.replaceRange(e,{line:n.line,ch:n.ch})},toggleAround:function(e,t){var n=this.cm.getDoc(),i=n.getCursor();if(n.somethingSelected()){var o=n.getSelection();o.startsWith(e)&&o.endsWith(t)?n.replaceSelection(o.substring(e.length,o.length-t.length),"around"):n.replaceSelection(e+o+t,"around")}else n.replaceRange(e+t,{line:i.line,ch:i.ch}),n.setCursor({line:i.line,ch:i.ch+e.length})},toggleBefore:function(e){var t=this.cm.getDoc(),n=t.getCursor();if(t.somethingSelected()){var i=t.listSelections(),o=null;this.cm.operation(function(){i.forEach(function(n){var i=[n.head.line,n.anchor.line].sort();null==o&&(o=t.getLine(i[0]).startsWith(e));for(var r=i[0];r<=i[1];r++)o?t.getLine(r).startsWith(e)&&t.replaceRange("",{line:r,ch:0},{line:r,ch:e.length}):t.replaceRange(e,{line:r,ch:0})})})}else{var r=n.line;t.getLine(r).startsWith(e)?t.replaceRange("",{line:r,ch:0},{line:r,ch:e.length}):t.replaceRange(e,{line:r,ch:0})}}}}(window.CodeMirror);